(function(m,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(m=typeof globalThis<"u"?globalThis:m||self,e(m["v-carousel-lucky"]={},m.Vue))})(this,function(m,e){"use strict";const Q="";let I,A;function O(a,l,r){return function(){let s=this,p=arguments;if(I&&clearTimeout(I),r){let f=!I;I=setTimeout(function(){I=null},l),f&&(A=a.apply(s,p))}else I=setTimeout(function(){a.apply(s,p)},l);return A}()}const Z="",D=(a,l)=>{const r=a.__vccOpts||a;for(const[d,s]of l)r[d]=s;return r},U={key:0,class:"indicator"},z=["onClick"],H=e.defineComponent({name:"indicator"}),P=D(Object.assign(H,{emits:["DicatorClick","before-moving","after-moving"],setup(a,{emit:l}){const r=e.inject("carouselCtxState"),d=r.propsStaging,s=e.reactive({len:r.CAROUSEL_ITEM_LEN,globalIndex:0,indicator:d.indicator,indicatorColor:d.indicatorColor,indicatorActiveColor:d.indicatorActiveColor});e.watch(()=>r.currentIndex,f=>{s.globalIndex=f});const p=f=>{if(f!==s.globalIndex){let u="next";f>s.globalIndex?u="next":u="prev",l("before-moving",{index:s.globalIndex,direction:u}),l("DicatorClick",f),l("after-moving",{index:f,direction:u})}};return(f,u)=>e.unref(s).indicator?(e.openBlock(),e.createElementBlock("div",U,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s).len,_=>(e.openBlock(),e.createElementBlock("span",{key:_,style:e.normalizeStyle({backgroundColor:e.unref(s).globalIndex===_-1?e.unref(s).indicatorActiveColor:e.unref(s).indicatorColor,width:e.unref(s).globalIndex===_-1?"20px":""}),onClick:y=>p(_-1)},null,12,z))),128))])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-8258f296"]]),W={containerWidth:{type:String,default:"100%"},containerHeight:{type:String,default:"100%"},duration:{type:Number,default:3e3},initIndex:{type:Number,default:0},autoplay:{type:Boolean,default:!0},direction:{type:Boolean,default:!0},directionMode:{type:String,default:"always"},indicator:{type:Boolean,default:!0},indicatorMode:{type:String,default:"always"},type:{type:String,validator:a=>["","card"].includes(a),default:""},loop:{type:Boolean,default:!0},delay:{type:Number,default:.3}},te="",R=a=>(e.pushScopeId("data-v-4a7355bf"),a=a(),e.popScopeId(),a),F={class:"direction-container"},X=[R(()=>e.createElementVNode("i",{class:"iconfont icon-anniu_jiantouxiangzuo_o"},null,-1))],Y=[R(()=>e.createElementVNode("i",{class:"iconfont icon-anniu-jiantouxiangyou_o"},null,-1))],q=e.defineComponent({name:"Carousel"}),w=D(Object.assign(q,{props:W,emits:["before-moving","after-moving"],setup(a,{emit:l}){const r=a,d=e.ref(null),s=e.useSlots(),{containerWidth:p,containerHeight:f,duration:u,directionMode:_,indicatorMode:y}=e.toRefs(r),t=e.reactive({CAROUSEL_ITEM_LEN:s.default()[0].children.length,propsStaging:r,currentIndex:r.initIndex,showDirection:!0,showIndicator:!0,loop:r.loop,type:r.type,delay:r.duration>r.delay?r.delay/1e3:.3}),C=e.ref([]);let x=null;const S=r.direction;e.watch(()=>t.currentIndex,(c,T)=>{$(T)});const E=()=>{x=setInterval(()=>{o("next")},u.value)},B=c=>{C.value.push(c)},k=c=>{l("before-moving",c)},M=c=>{l("after-moving",c)},n=c=>{switch(k({index:t.currentIndex,direction:c}),c){case"prev":(t.currentIndex>0||r.loop)&&(t.currentIndex-=1),t.currentIndex<=-1&&(t.currentIndex=t.CAROUSEL_ITEM_LEN-1);break;case"next":(t.currentIndex<t.CAROUSEL_ITEM_LEN-1||r.loop)&&(t.currentIndex+=1),t.currentIndex>=t.CAROUSEL_ITEM_LEN&&(t.currentIndex=0);break}M({index:t.currentIndex,direction:c})},o=c=>O(()=>n(c),r.delay,!0),i=c=>{c<t.currentIndex&&changeLeftTranslate(),t.currentIndex=c,$()},h=()=>{j(),_.value==="hover"&&(t.showDirection=!0),y.value==="hover"&&(t.showIndicator=!0)},g=()=>{E(),_.value==="hover"&&(t.showDirection=!1),y.value==="hover"&&(t.showIndicator=!1)},L=()=>{o("prev")},N=()=>{o("next")};function j(){clearInterval(x),x=null}const $=c=>{C.value.forEach((T,K)=>{T.setItemStyle(K,t.currentIndex,c)})};return e.provide("carouselCtxState",t),e.provide("instance",{items:C,addItems:B,carouselRoot:d}),e.onMounted(async()=>{await e.nextTick(),$(),r.autoplay&&E(),_.value==="hover"&&(t.showDirection=!1),y.value==="hover"&&(t.showIndicator=!1)}),e.onBeforeUnmount(()=>{j()}),(c,T)=>(e.openBlock(),e.createElementBlock("div",{class:"Carousel",ref_key:"carouselRoot",ref:d,onMouseenter:h,onMouseleave:g,style:e.normalizeStyle({width:e.unref(p),height:e.unref(f)})},[e.renderSlot(c.$slots,"default",{},void 0,!0),e.createElementVNode("div",F,[e.withDirectives(e.createVNode(e.Transition,{name:"left-arrow"},{default:e.withCtx(()=>[e.createElementVNode("div",{class:"prev",onClick:L},X)]),_:1},512),[[e.vShow,e.unref(S)&&e.unref(t).showDirection]]),e.withDirectives(e.createVNode(e.Transition,{name:"right-arrow"},{default:e.withCtx(()=>[e.createElementVNode("div",{class:"next",onClick:N},Y)]),_:1},512),[[e.vShow,e.unref(S)&&e.unref(t).showDirection]])]),e.withDirectives(e.createVNode(P,{onBeforeMoving:k,onAfterMoving:M,onDicatorClick:i},null,512),[[e.vShow,e.unref(t).showIndicator]])],36))}}),[["__scopeId","data-v-4a7355bf"]]),ae="",v=e.defineComponent({name:"CarouselItem"}),b=D(Object.assign(v,{props:{idx:{type:Number,default:0}},setup(a){const l=a;e.toRefs(l);const r=e.reactive({globalIndex:0}),d=.8;let s=e.ref(1),p=e.ref(0),f=e.ref("X");const u=e.inject("carouselCtxState");let _=e.ref(!1),y=e.ref(!1);const t=e.inject("instance");e.watch(()=>u.currentIndex,n=>{r.globalIndex=n});const C=(n,o)=>o?n:"",x=e.computed(()=>{const n=`translate${f.value==="Y"?"Y":"X"}`,o=`scale(${s.value})`;return{transform:[`${n}(${p.value}px)`,o].join(" ")}}),S=e.computed(()=>{var n;return((n=t.carouselRoot.value)==null?void 0:n.offsetWidth)||0}),E=(n,o,i)=>{const h=i-1,g=o-1,L=o+1,N=i/2;return o===0&&n===h?-1:o===h&&n===0?i:n<g&&o-n>=N?i+1:n>L&&n-o>=N?-2:n},B=(n,o)=>{const i=t.carouselRoot.value;return i?i.offsetWidth*(n-o):0},k=(n,o,i)=>y.value?i*((2-d)*(n-o)+1)/4:n<o?-(1+d)*i/4:(3+d)*i/4,M=(n,o,i)=>{const h=t.items.value.length||0,g=_.value=n===o;!_.value&&h>2&&u.loop&&(n=E(n,o,h)),u.type==="card"?(y.value=Math.round(Math.abs(n-o))<=1,p.value=k(n,o,S.value),s.value=g?1:d):p.value=B(n,o)};return e.onMounted(()=>{t.addItems({setItemStyle:M})}),(n,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["CarouselItem",[C("is-active",e.unref(_)),C("is-card",e.unref(u).type==="card")]]),style:e.normalizeStyle([e.unref(x),{"--delay":e.unref(u).delay+"s"}])},[e.renderSlot(n.$slots,"default",{},void 0,!0)],6))}}),[["__scopeId","data-v-ae21e3ba"]]);w.install=a=>{a.component("Carousel",w)},b.install=a=>{a.component("CarouselItem",b)};const G=[w,b],V=a=>{G.forEach(l=>{a.use(l)})};typeof window<"u"&&window.Vue&&V(window.Vue);const J={install:V};m.Carousel=w,m.CarouselItem=b,m.default=J,Object.defineProperties(m,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
