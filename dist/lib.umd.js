(function(m,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(m=typeof globalThis<"u"?globalThis:m||self,e(m["v-carousel-lucky"]={},m.Vue))})(this,function(m,e){"use strict";const Q="";let I,R;function O(a,l,r){return function(){let s=this,p=arguments;if(I&&clearTimeout(I),r){let f=!I;I=setTimeout(function(){I=null},l),f&&(R=a.apply(s,p))}else I=setTimeout(function(){a.apply(s,p)},l);return R}()}const Z="",D=(a,l)=>{const r=a.__vccOpts||a;for(const[d,s]of l)r[d]=s;return r},z={key:0,class:"indicator"},U=["onClick"],H=e.defineComponent({name:"indicator"}),P=D(Object.assign(H,{emits:["DictatorClick","before-moving","after-moving"],setup(a,{emit:l}){const r=e.inject("carouselCtxState"),d=r.propsStaging,s=e.reactive({len:r.CAROUSEL_ITEM_LEN,globalIndex:0,indicator:d.indicator,indicatorColor:d.indicatorColor,indicatorActiveColor:d.indicatorActiveColor});e.watch(()=>r.currentIndex,f=>{s.globalIndex=f});const p=f=>{if(f!==s.globalIndex){let u="next";f>s.globalIndex?u="next":u="prev",l("before-moving",{index:s.globalIndex,direction:u}),l("DictatorClick",f),l("after-moving",{index:f,direction:u})}};return(f,u)=>e.unref(s).indicator?(e.openBlock(),e.createElementBlock("div",z,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s).len,_=>(e.openBlock(),e.createElementBlock("span",{key:_,style:e.normalizeStyle({width:e.unref(s).globalIndex===_-1?"20px":""}),onClick:y=>p(_-1),class:e.normalizeClass(e.unref(s).globalIndex===_-1?"active":"normal")},null,14,U))),128))])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-c2c4caa3"]]),W={containerWidth:{type:String,default:"100%"},containerHeight:{type:String,default:"100%"},duration:{type:Number,default:3e3},initIndex:{type:Number,default:0},autoplay:{type:Boolean,default:!0},direction:{type:Boolean,default:!0},directionMode:{type:String,default:"always"},indicator:{type:Boolean,default:!0},indicatorMode:{type:String,default:"always"},type:{type:String,validator:a=>["","card"].includes(a),default:""},loop:{type:Boolean,default:!0},delay:{type:Number,default:300}},te="",V=a=>(e.pushScopeId("data-v-097fc2bf"),a=a(),e.popScopeId(),a),F={class:"direction-container"},X=[V(()=>e.createElementVNode("i",{class:"iconfont icon-anniu_jiantouxiangzuo_o"},null,-1))],Y=[V(()=>e.createElementVNode("i",{class:"iconfont icon-anniu-jiantouxiangyou_o"},null,-1))],q=e.defineComponent({name:"Carousel"}),w=D(Object.assign(q,{props:W,emits:["before-moving","after-moving"],setup(a,{emit:l}){const r=a,d=e.ref(null),s=e.useSlots(),{containerWidth:p,containerHeight:f,duration:u,directionMode:_,indicatorMode:y}=e.toRefs(r),n=e.reactive({CAROUSEL_ITEM_LEN:s.default()[0].children.length,propsStaging:r,currentIndex:r.initIndex,showDirection:!0,showIndicator:!0,loop:r.loop,type:r.type,delay:r.duration>r.delay?r.delay/1e3:.3}),x=e.ref([]);let C=null;const b=r.direction;e.watch(()=>n.currentIndex,(c,T)=>{L(T)});const E=()=>{C=setInterval(()=>{o("next")},u.value)},B=c=>{x.value.push(c)},k=c=>{l("before-moving",c)},M=c=>{l("after-moving",c)},t=c=>{switch(k({index:n.currentIndex,direction:c}),c){case"prev":(n.currentIndex>0||r.loop)&&(n.currentIndex-=1),n.currentIndex<=-1&&(n.currentIndex=n.CAROUSEL_ITEM_LEN-1);break;case"next":(n.currentIndex<n.CAROUSEL_ITEM_LEN-1||r.loop)&&(n.currentIndex+=1),n.currentIndex>=n.CAROUSEL_ITEM_LEN&&(n.currentIndex=0);break}M({index:n.currentIndex,direction:c})},o=c=>O(()=>t(c),r.delay,!0),i=c=>{n.currentIndex=c,L()},h=()=>{A(),_.value==="hover"&&(n.showDirection=!0),y.value==="hover"&&(n.showIndicator=!0)},g=()=>{E(),_.value==="hover"&&(n.showDirection=!1),y.value==="hover"&&(n.showIndicator=!1)},$=()=>{o("prev")},N=()=>{o("next")};function A(){clearInterval(C),C=null}const L=c=>{x.value.forEach((T,K)=>{T.setItemStyle(K,n.currentIndex,c)})};return e.provide("carouselCtxState",n),e.provide("instance",{items:x,addItems:B,carouselRoot:d}),e.onMounted(async()=>{await e.nextTick(),L(),r.autoplay&&E(),_.value==="hover"&&(n.showDirection=!1),y.value==="hover"&&(n.showIndicator=!1)}),e.onBeforeUnmount(()=>{A()}),(c,T)=>(e.openBlock(),e.createElementBlock("div",{class:"Carousel",ref_key:"carouselRoot",ref:d,onMouseenter:h,onMouseleave:g,style:e.normalizeStyle({width:e.unref(p),height:e.unref(f)})},[e.renderSlot(c.$slots,"default",{},void 0,!0),e.createElementVNode("div",F,[e.withDirectives(e.createVNode(e.Transition,{name:"left-arrow"},{default:e.withCtx(()=>[e.createElementVNode("div",{class:"prev",onClick:$},X)]),_:1},512),[[e.vShow,e.unref(b)&&e.unref(n).showDirection]]),e.withDirectives(e.createVNode(e.Transition,{name:"right-arrow"},{default:e.withCtx(()=>[e.createElementVNode("div",{class:"next",onClick:N},Y)]),_:1},512),[[e.vShow,e.unref(b)&&e.unref(n).showDirection]])]),e.withDirectives(e.createVNode(P,{onBeforeMoving:k,onAfterMoving:M,onDictatorClick:i},null,512),[[e.vShow,e.unref(n).showIndicator]])],36))}}),[["__scopeId","data-v-097fc2bf"]]),ae="",v=e.defineComponent({name:"CarouselItem"}),S=D(Object.assign(v,{props:{idx:{type:Number,default:0}},setup(a){const l=a;e.toRefs(l);const r=e.reactive({globalIndex:0}),d=.8;let s=e.ref(1),p=e.ref(0),f=e.ref("X");const u=e.inject("carouselCtxState");let _=e.ref(!1),y=e.ref(!1);const n=e.inject("instance");e.watch(()=>u.currentIndex,t=>{r.globalIndex=t});const x=(t,o)=>o?t:"",C=e.computed(()=>{const t=`translate${f.value==="Y"?"Y":"X"}`,o=`scale(${s.value})`;return{transform:[`${t}(${p.value}px)`,o].join(" ")}}),b=e.computed(()=>{var t;return((t=n.carouselRoot.value)==null?void 0:t.offsetWidth)||0}),E=(t,o,i)=>{const h=i-1,g=o-1,$=o+1,N=i/2;return o===0&&t===h?-1:o===h&&t===0?i:t<g&&o-t>=N?i+1:t>$&&t-o>=N?-2:t},B=(t,o)=>{const i=n.carouselRoot.value;return i?i.offsetWidth*(t-o):0},k=(t,o,i)=>y.value?i*((2-d)*(t-o)+1)/4:t<o?-(1+d)*i/4:(3+d)*i/4,M=(t,o,i)=>{const h=n.items.value.length||0,g=_.value=t===o;!_.value&&h>2&&u.loop&&(t=E(t,o,h)),u.type==="card"?(y.value=Math.round(Math.abs(t-o))<=1,p.value=k(t,o,b.value),s.value=g?1:d):p.value=B(t,o)};return e.onMounted(()=>{n.addItems({setItemStyle:M})}),(t,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["CarouselItem",[x("is-active",e.unref(_)),x("is-card",e.unref(u).type==="card")]]),style:e.normalizeStyle([e.unref(C),{"--delay":e.unref(u).delay+"s"}])},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6))}}),[["__scopeId","data-v-ae21e3ba"]]);w.install=a=>{a.component("Carousel",w)},S.install=a=>{a.component("CarouselItem",S)};const G=[w,S],j=a=>{G.forEach(l=>{a.use(l)})};typeof window<"u"&&window.Vue&&j(window.Vue);const J={install:j};m.Carousel=w,m.CarouselItem=S,m.default=J,Object.defineProperties(m,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
