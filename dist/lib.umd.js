(function(h,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(h=typeof globalThis<"u"?globalThis:h||self,e(h["v-carousel-lucky"]={},h.Vue))})(this,function(h,e){"use strict";const oe="";let I,j;function P(a,d,r){return function(){let c=this,s=arguments;if(I&&clearTimeout(I),r){let m=!I;I=setTimeout(function(){I=null},d),m&&(j=a.apply(c,s))}else I=setTimeout(function(){a.apply(c,s)},d);return j}()}const re="",M=(a,d)=>{const r=a.__vccOpts||a;for(const[u,c]of d)r[u]=c;return r},z=["onClick","onMouseenter"],U=e.defineComponent({name:"indicator"}),W=M(Object.assign(U,{emits:["indicatorClick","before-move","change-move"],setup(a,{emit:d}){const r=e.inject("carouselCtxState"),u=r.propsStaging,c=e.reactive({len:r.CAROUSEL_ITEM_LEN,globalIndex:0,indicator:u.indicator,indicatorColor:u.indicatorColor,indicatorActiveColor:u.indicatorActiveColor,indicatorPosition:u.indicatorPosition,indicatorTrigger:r.indicatorTrigger});e.watch(()=>r.currentIndex,f=>{c.globalIndex=f});const s=f=>{if(f!==c.globalIndex){let p="next";f>c.globalIndex?p="next":p="prev",d("before-move",{index:c.globalIndex,direction:p}),d("indicatorClick",f),d("change-move",{index:f,direction:p})}},m=f=>{c.indicatorTrigger==="hover"&&s(f)};return(f,p)=>e.unref(c).indicator?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["indicator",e.unref(c).indicatorPosition==="inside"?"absolute":"static"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c).len,_=>(e.openBlock(),e.createElementBlock("span",{key:_,style:e.normalizeStyle({width:e.unref(c).globalIndex===_-1?"20px":""}),onClick:g=>s(_-1),onMouseenter:g=>m(_-1),class:e.normalizeClass(e.unref(c).globalIndex===_-1?"active":"normal")},null,46,z))),128))],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-2625b473"]]),x=.8,F={width:{type:String,default:"400px"},height:{type:String,default:"300px"},duration:{type:Number,default:3e3},initIndex:{type:Number,default:0},autoplay:{type:Boolean,default:!0},direction:{type:Boolean,default:!0},directionMode:{type:String,default:"always"},indicator:{type:Boolean,default:!0},indicatorMode:{type:String,default:"always"},indicatorPosition:{type:String,default:"inside"},indicatorTrigger:{type:String,default:"hover"},type:{type:String,validator:a=>["","card"].includes(a),default:""},loop:{type:Boolean,default:!0},delay:{type:Number,default:300},scale:{type:Number,default:x},cardWidth:{type:String,default:"50%"}},se="",R=a=>(e.pushScopeId("data-v-d4698b8c"),a=a(),e.popScopeId(),a),H={class:"direction-container"},X=[R(()=>e.createElementVNode("i",{class:"iconfont icon-anniu_jiantouxiangzuo_o"},null,-1))],Y=[R(()=>e.createElementVNode("i",{class:"iconfont icon-anniu-jiantouxiangyou_o"},null,-1))],q=e.defineComponent({name:"Carousel"}),S=M(Object.assign(q,{props:F,emits:["before-move","change-move"],setup(a,{emit:d}){const r=a,u=e.ref(null),c=e.useSlots(),{width:s,height:m,duration:f,directionMode:p,indicatorMode:_,indicatorPosition:g,indicatorTrigger:N,scale:B,cardWidth:$,type:L}=e.toRefs(r),n=e.reactive({CAROUSEL_ITEM_LEN:c.default()[0].children.length,propsStaging:r,currentIndex:r.initIndex,showDirection:!0,showIndicator:!0,loop:r.loop,type:r.type,delay:r.duration>r.delay?r.delay/1e3:.3,indicatorPosition:g,indicatorTrigger:N,scale:B,type:L,cardWidth:$}),w=e.ref([]);let t=null;const o=r.direction;e.watch(()=>n.currentIndex,(l,T)=>{V(T)});const i=()=>{t=setInterval(()=>{D("next")},f.value)},y=l=>{w.value.push(l)},C=l=>{d("before-move",l)},E=l=>{d("change-move",l)},k=l=>{switch(C({index:n.currentIndex,direction:l}),l){case"prev":(n.currentIndex>0||r.loop)&&(n.currentIndex-=1),n.currentIndex<=-1&&(n.currentIndex=n.CAROUSEL_ITEM_LEN-1);break;case"next":(n.currentIndex<n.CAROUSEL_ITEM_LEN-1||r.loop)&&(n.currentIndex+=1),n.currentIndex>=n.CAROUSEL_ITEM_LEN&&(n.currentIndex=0);break}E({index:n.currentIndex,direction:l})},D=l=>P(()=>k(l),r.delay,!0),Q=l=>{n.currentIndex=l,V()},Z=()=>{O(),p.value==="hover"&&(n.showDirection=!0),_.value==="hover"&&(n.showIndicator=!0)},v=()=>{console.log(),p.value==="hover"&&(n.showDirection=!1),_.value==="hover"&&(n.showIndicator=!1)},ee=()=>{D("prev")},te=()=>{D("next")};function O(){clearInterval(t),t=null}const V=l=>{w.value.forEach((T,ne)=>{T.setItemStyle(ne,n.currentIndex,l)})};return e.provide("carouselCtxState",n),e.provide("instance",{items:w,addItems:y,carouselRoot:u}),e.onMounted(async()=>{await e.nextTick(),V(),r.autoplay&&i(),p.value==="hover"&&(n.showDirection=!1),_.value==="hover"&&(n.showIndicator=!1)}),e.onBeforeUnmount(()=>{O()}),(l,T)=>(e.openBlock(),e.createElementBlock("div",{class:"Carousel",ref_key:"carouselRoot",ref:u,onMouseenter:Z,onMouseleave:v,style:e.normalizeStyle({width:e.unref(s)})},[e.createElementVNode("div",{class:"carousel-container",style:e.normalizeStyle({height:e.unref(m)})},[e.renderSlot(l.$slots,"default",{},void 0,!0)],4),e.createElementVNode("div",H,[e.createVNode(e.Transition,{name:"left-arrow"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{class:"prev",onClick:ee},X,512),[[e.vShow,e.unref(o)&&e.unref(n).showDirection]])]),_:1}),e.createVNode(e.Transition,{name:"right-arrow"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",{class:"next",onClick:te},Y,512),[[e.vShow,e.unref(o)&&e.unref(n).showDirection]])]),_:1})]),e.withDirectives(e.createVNode(W,{onBeforeMove:C,onChangeMove:E,onIndicatorClick:Q},null,512),[[e.vShow,e.unref(n).showIndicator]])],36))}}),[["__scopeId","data-v-d4698b8c"]]),de="",G=e.defineComponent({name:"CarouselItem"}),b=M(Object.assign(G,{setup(a){const d=e.reactive({globalIndex:0});let r=e.ref(1),u=e.ref(0),c=e.ref("X");const s=e.inject("carouselCtxState");let m=e.ref(!1),f=e.ref(!1),p=e.ref(!1);const _=e.inject("instance");e.watch(()=>s.currentIndex,t=>{d.globalIndex=t});const g=(t,o)=>o?t:"",N=e.computed(()=>{const t=`translate${c.value==="Y"?"Y":"X"}`,o=`scale(${r.value})`;return{transform:[`${t}(${u.value}px)`,o].join(" ")}}),B=e.computed(()=>{var t;return((t=_.carouselRoot.value)==null?void 0:t.offsetWidth)||0}),$=(t,o,i)=>{const y=i-1,C=o-1,E=o+1,k=i/2;return o===0&&t===y?-1:o===y&&t===0?i:t<C&&o-t>=k?i+1:t>E&&t-o>=k?-2:t},L=(t,o)=>{const i=_.carouselRoot.value;return i?i.offsetWidth*(t-o):0},n=(t,o,i)=>f.value?t===o&&s.type==="card"&&s.cardWidth&&s.cardWidth!=="50%"?(i-parseInt(s.cardWidth.replace("px","")))/2:i*((2-x)*(t-o)+1)/4:t<o?-(1+x)*i/4:(console.log(t,o),(3+x)*i/4),w=(t,o,i)=>{const y=_.items.value.length||0,C=m.value=t===o;!m.value&&y>2&&s.loop&&(t=$(t,o,y)),s.type==="card"?(f.value=Math.round(Math.abs(t-o))<=1,u.value=n(t,o,B.value),console.log(u.value),r.value=C?1:s.scale>1?x:s.scale):u.value=L(t,o),p.value=!0};return e.onMounted(()=>{_.addItems({setItemStyle:w})}),(t,o)=>e.withDirectives((e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["carousel-item",[g("is-active",e.unref(m)),g("is-stage",e.unref(f)),g("is-card",e.unref(s).type==="card")]]),style:e.normalizeStyle([e.unref(N),{"--delay":e.unref(s).delay+"s"},{"--width":e.unref(s).cardWidth}])},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)),[[e.vShow,e.unref(p)]])}}),[["__scopeId","data-v-070eee51"]]);S.install=a=>{a.component("Carousel",S)},b.install=a=>{a.component("CarouselItem",b)};const J=[S,b],A=a=>{J.forEach(d=>{a.use(d)})};typeof window<"u"&&window.Vue&&A(window.Vue);const K={install:A};h.Carousel=S,h.CarouselItem=b,h.default=K,Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
